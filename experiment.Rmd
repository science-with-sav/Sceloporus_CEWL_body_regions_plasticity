---
title: "BIO 324, Herpetology CURE"
author: "Savannah Weaver"
date: "Spring Quarter 2021"
output: pdf_document
---

# Packages

```{r setup, include=FALSE}
if (!require("tidyverse")) install.packages("tidyverse")
library("tidyverse")
if (!require("UsingR")) install.packages("UsingR")
library("UsingR")
```

*make sure Tess went through and checked all the data*

# Data

### Treatment Groups

variables:
-
-

```{r}
tmts <- read.csv("./data/exp_tmt_assignment.csv")
```


### Capture Data

```{r capture data}
capture_hydration <- read.csv("./capture_hydration.csv",
                             na.strings=c("","NA") # fix empty cells
                             ) %>%
  mutate(# correctly format date-only variable
         date = as.Date(date, format = "%Y-%m-%d")
         ) %>%
  # select only relevant variables
  dplyr::select(date, individual_ID, 
                mass_g, hematocrit_percent, osmolality_mmol_kg
                ) %>%
  dplyr::filter(individual_ID %in% exp_dat$individual_ID) %>%
  mutate(type = as.factor("capture"))
summary(capture_hydration)
```


### Experiment Data

**NOTE: this is not all the data**

```{r}
exp_dat <- read.csv("./data/experimental_data.csv",
                             na.strings=c("","NA") # fix empty cells
                             ) %>%
                # format date
  dplyr::mutate(date = as.Date(date, format = "%m/%d/%y"),
                type = as.factor(type)
                ) %>%
  # select only variables to be analyzed
  dplyr::select(date, individual_ID, mass_g, 
                hematocrit_percent, osmolality_mmol_kg, type)
summary(exp_dat)
```

### Join Dataframes

```{r}
all_dat <- exp_dat %>%
  rbind(capture_hydration) %>%
  left_join(tmts, by = "individual_ID") %>%
  dplyr::select(-notes) %>%
  dplyr::filter(conclusion == "complete") %>%
  group_by(individual_ID) %>%
  mutate(capture_date = min(date),
         day = as.numeric(date - capture_date),
         humidity_tmt_percent = as.factor(humidity_tmt_percent)
         )
summary(all_dat)

# check that capture dates are valid
unique(all_dat$capture_date)
```





# Data Cleaning

## Histograms

### Mass

```{r}
exp_dat %>%
  ggplot(., aes(x = mass_g)) +
  geom_histogram(color = "black", fill="steelblue", bins=50) + 
  theme_classic() +
  xlab("Mass (g)") + 
  ylab("Count")
simple.eda(exp_dat$mass_g)
shapiro.test(exp_dat$mass_g)
```

Mass distribution not normal, skewed to the left.

### Hematocrit

```{r}
exp_dat %>%
  ggplot(., aes(x = hematocrit_percent)) +
  geom_histogram(color = "black", fill="steelblue", bins=50) + 
  theme_classic() +
  xlab("Hematocrit (%)") + 
  ylab("Count")
simple.eda(exp_dat$hematocrit_percent)
shapiro.test(exp_dat$hematocrit_percent)
```

Visually, looks slightly skewed to the right, but statistically, the distribution of hematocrit is normal.


### Osmolality

```{r}
exp_dat %>%
  ggplot(., aes(x = osmolality_mmol_kg)) +
  geom_histogram(color = "black", fill="steelblue", bins=50) + 
  theme_classic() +
  xlab("Osmolality (mmol / kg)") + 
  ylab("Count")
simple.eda(exp_dat$osmolality_mmol_kg)
shapiro.test(exp_dat$osmolality_mmol_kg)
```

Visually, looks slightly skewed to the right, but statistically, the distribution of osmolality is normal.













# Basic Figures & SLR


### Mass ~ Time

```{r}
all_dat %>% 
  dplyr::filter(type != "rehab") %>%
  ggplot(data = .) + 
  geom_point(aes(x = day,
                 y = mass_g, 
                 color = as.factor(individual_ID)
                 ), 
             size = 1, 
             alpha = 0.6) +
  stat_smooth(aes(x = day, 
                  y = mass_g, 
                  color = as.factor(individual_ID)
                  ), 
              formula = y ~ x, 
              method = "lm", 
              se = F, 
              size = 1.6, 
              alpha = 1 ) + 
  theme_classic() + 
  scale_x_continuous(breaks = c(0, 2, 4, 6, 8)) +
  xlab("Day") + 
  ylab("Mass (g)") + 
  theme(text = element_text(color = "black", 
                            family = "sans", 
                            size = 12),
        axis.text = element_text(color = "black", 
                                 family = "sans", 
                                 size = 10),
        legend.text.align = 0,
        legend.position = "none"
)
```

```{r}
all_dat %>% 
  dplyr::filter(type != "rehab") %>%
  ggplot(data = .) + 
  geom_point(aes(x = day,
                 y = mass_g, 
                 color = humidity_tmt_percent
                 ), 
             size = 1, 
             alpha = 0.6) +
  stat_smooth(aes(x = day, 
                  y = mass_g, 
                  color = humidity_tmt_percent
                  ), 
              formula = y ~ x, 
              method = "lm", 
              se = F, 
              size = 1.6, 
              alpha = 1 ) + 
  theme_classic() + 
  scale_x_continuous(breaks = c(0, 2, 4, 6, 8)) +
  xlab("Day") + 
  ylab("Mass (g)") + 
  theme(text = element_text(color = "black", 
                            family = "sans", 
                            size = 12),
        axis.text = element_text(color = "black", 
                                 family = "sans", 
                                 size = 10),
        legend.text.align = 0
)
```


### Hct ~ Time

```{r}
all_dat %>% 
  dplyr::filter(type != "rehab") %>%
  ggplot(data = .) + 
  geom_point(aes(x = day,
                 y = hematocrit_percent, 
                 color = as.factor(individual_ID)
                 ), 
             size = 1, 
             alpha = 0.6) +
  stat_smooth(aes(x = day, 
                  y = hematocrit_percent, 
                  color = as.factor(individual_ID)
                  ), 
              formula = y ~ x, 
              method = "lm", 
              se = F, 
              size = 1.6, 
              alpha = 1 ) + 
  theme_classic() + 
  scale_x_continuous(breaks = c(0, 2, 4, 6, 8)) +
  xlab("Day") + 
  ylab("Hematocrit (%)") + 
  theme(text = element_text(color = "black", 
                            family = "sans", 
                            size = 12),
        axis.text = element_text(color = "black", 
                                 family = "sans", 
                                 size = 10),
        legend.text.align = 0,
        legend.position = "none"
)
```

```{r}
all_dat %>% 
  dplyr::filter(type != "rehab") %>%
  ggplot(data = .) + 
  geom_point(aes(x = day,
                 y = hematocrit_percent, 
                 color = humidity_tmt_percent
                 ), 
             size = 1, 
             alpha = 0.6) +
  stat_smooth(aes(x = day, 
                  y = hematocrit_percent, 
                  color = humidity_tmt_percent
                  ), 
              formula = y ~ x, 
              method = "lm", 
              se = F, 
              size = 1.6, 
              alpha = 1 ) + 
  theme_classic() + 
  scale_x_continuous(breaks = c(0, 2, 4, 6, 8)) +
  xlab("Day") + 
  ylab("Hematocrit (%)") + 
  theme(text = element_text(color = "black", 
                            family = "sans", 
                            size = 12),
        axis.text = element_text(color = "black", 
                                 family = "sans", 
                                 size = 10),
        legend.text.align = 0
)
```


### Osml ~ Time

```{r}
all_dat %>% 
  dplyr::filter(type != "rehab") %>%
  ggplot(data = .) + 
  geom_point(aes(x = day,
                 y = osmolality_mmol_kg, 
                 color = as.factor(individual_ID)
                 ), 
             size = 1, 
             alpha = 0.6) +
  stat_smooth(aes(x = day, 
                  y = osmolality_mmol_kg, 
                  color = as.factor(individual_ID)
                  ), 
              formula = y ~ x, 
              method = "lm", 
              se = F, 
              size = 1.6, 
              alpha = 1 ) + 
  theme_classic() + 
  scale_x_continuous(breaks = c(0, 2, 4, 6, 8)) +
  xlab("Day") + 
  ylab("Osmolality (mmol / kg)") + 
  theme(text = element_text(color = "black", 
                            family = "sans", 
                            size = 12),
        axis.text = element_text(color = "black", 
                                 family = "sans", 
                                 size = 10),
        legend.text.align = 0,
        legend.position = "none")
```

```{r}
all_dat %>% 
  dplyr::filter(type != "rehab") %>%
  ggplot(data = .) + 
  geom_point(aes(x = day,
                 y = osmolality_mmol_kg, 
                 color = humidity_tmt_percent
                 ), 
             size = 1, 
             alpha = 0.6) +
  stat_smooth(aes(x = day, 
                  y = osmolality_mmol_kg, 
                  color = humidity_tmt_percent
                  ), 
              formula = y ~ x, 
              method = "lm", 
              se = F, 
              size = 1.6, 
              alpha = 1 ) + 
  theme_classic() + 
  scale_x_continuous(breaks = c(0, 2, 4, 6, 8)) +
  xlab("Date") + 
  ylab("Osmolality (mmol / kg)") + 
  theme(text = element_text(color = "black", 
                            family = "sans", 
                            size = 12),
        axis.text = element_text(color = "black", 
                                 family = "sans", 
                                 size = 10),
        legend.text.align = 0
)
```






# Export to Use for Power Analyses for Next Iteration of the Experiment













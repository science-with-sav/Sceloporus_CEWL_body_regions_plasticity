---
title: "Experimental Data Analysis"
author: "Savannah Weaver"
date: "June 2021"
output: 
  github_document:
    toc: TRUE
---

# Packages

```{r setup, include=FALSE}
if (!require("tidyverse")) install.packages("tidyverse")
library("tidyverse")
if (!require("UsingR")) install.packages("UsingR")
library("UsingR")
if (!require("PerformanceAnalytics")) install.packages("PerformanceAnalytics") 
library("PerformanceAnalytics") # pretty multicollinearity plots
if (!require("MASS")) install.packages("MASS")
library("MASS") # model selection & box-cox
if (!require("lme4")) install.packages("lme4")
library("lme4") # for LMMs
```


# Data

## Morphometrics & Hydration

### Treatment Groups

variables:
- individual lizard ID
- temp_tmt_C = temperature treatment
- humidity_tmt_percent = humidity treatment (high/low, not actually %)
- trial_number = which set of lizards that individual was from
- conclusion = how that individual's experiment ended (died, canceled, or complete)

```{r}
tmts <- read.csv("./data/exp_tmt_assignment.csv")
```


### Capture Data

variables:
- date = date of capture & baseline measurements
- individual lizard ID
- mass_g = mass in grams
- hematocrit_percent = % of blood sample that's red blood cells
- osmolality_mmol_kg = concentration of solutes in blood plasma
- type = when the measurements were taken along the course of the experiment (all on capture day)

```{r capture data}
capture_hydration <- read.csv("./exported_data/capture_hydration.csv",
                             na.strings=c("","NA") # fix empty cells
                             ) %>%
  mutate(# correctly format date-only variable
         date = as.Date(date, format = "%Y-%m-%d")
         ) %>%
  # select only relevant variables
  dplyr::select(date, individual_ID, 
                mass_g, hematocrit_percent, osmolality_mmol_kg
                ) %>%
  dplyr::filter(individual_ID %in% tmts$individual_ID) %>%
  mutate(type = as.factor("capture"))
summary(capture_hydration)
```


extract SVL data separately from capture data:

```{r SVL}
SVL <- read.csv("./exported_data/capture_hydration.csv",
                             na.strings=c("","NA") # fix empty cells
                             ) %>%
  dplyr::select(individual_ID, SVL_mm) %>%
  dplyr::filter(individual_ID %in% tmts$individual_ID)
summary(SVL)
```


### Experiment Data

variables:
- date = date of capture & baseline measurements
- individual lizard ID
- mass_g = mass in grams
- hematocrit_percent = % of blood sample that's red blood cells
- osmolality_mmol_kg = concentration of solutes in blood plasma
- type = when the measurements were taken along the course of the experiment (either during experimental treatment or after rehab)

```{r}
exp_dat <- read.csv("./data/experimental_data.csv",
                             na.strings=c("","NA") # fix empty cells
                             ) %>%
                # format date
  dplyr::mutate(date = as.Date(date, format = "%m/%d/%y"),
                type = as.factor(type)
                ) %>%
  # select only variables to be analyzed
  dplyr::select(date, individual_ID, mass_g, 
                hematocrit_percent, type, 
                osmolality_mmol_kg = osmolality_mmol_kg_replicate_mean)
summary(exp_dat)
```

### Join Dataframes

Now, attach all the dataframes, only use individuals whose treatment was completed, and add a "day" variable for what day of treatment each lizard/observation was on.

I also calculate body condition index (BCI) using two different methods: log-residuals and scaled mass index.

```{r}
all_dat <- exp_dat %>%
  # join data
  rbind(capture_hydration) %>%
  # add tmt group info
  left_join(tmts, by = "individual_ID") %>%
  dplyr::select(-notes) %>%
  # add SVL value for each obs of each indiv.
  # for computing BCI and scaled mass indices
  left_join(SVL, by = "individual_ID") %>%
  # only use completed experiment runs
  dplyr::filter(conclusion == "complete") %>%
  group_by(individual_ID) %>%
  # reformat a lot of variables
  mutate(capture_date = min(date),
         day = as.numeric(date - capture_date),
         humidity_tmt_percent = as.factor(humidity_tmt_percent),
         individual_ID = as.factor(individual_ID),
         temp_tmt_C = as.factor(temp_tmt_C),
         trial_number = as.factor(trial_number),
         conclusion = as.factor(conclusion),
         
  # calculate body condition index as log-residuals
         BCI_log_res = 1,
  # calculate body condition index as scaled mass index
         BCI_scaled_mass = 2
         )

summary(all_dat)

# check that capture dates are valid
unique(all_dat$capture_date)
```


## Compute Scaled Mass Index

As described by Peig, J., & Green, A. J. (2009). New perspectives for estimating body condition from mass/length data: The scaled mass index as an alternative method. Oikos, 118(12), 1883â€“1891. https://doi.org/10.1111/j.1600-0706.2009.17643.x

### Step 1: mass ~ SVL

plot:

```{r}
all_dat %>% 
  ggplot(data = .) + 
  geom_point(aes(x = SVL_mm,
                 y = mass_g, 
                 ), 
             size = 1, 
             alpha = 0.6) + 
  stat_smooth(aes(x = SVL_mm, 
                  y = mass_g, 
                  ), 
              formula = y ~ x, 
              method = "lm", 
              color = "gray",
              se = F, 
              size = 1.6, 
              alpha = 1 ) + 
  theme_classic() + 
  xlab("SVL") + 
  ylab("Mass") + 
  theme(text = element_text(color = "black", 
                            family = "sans", 
                            size = 12),
        axis.text = element_text(color = "black", 
                                 family = "sans", 
                                 size = 10),
        legend.text.align = 0
)
```

create a simple linear regression 

```{r}
mass_SVL_SLR <- lm(data = all_dat, mass_g ~ SVL_mm)
summary(mass_SVL_SLR)
```

look for outliers 

```{r}
mass_SVL_SLR_residuals <- all_dat %>%
  mutate(try = 1)

test <- data.frame(residuals(mass_SVL_SLR))
summary(mass_SVL_SLR_residuals)
```


I think we should exclude the points at SVL=63


## Compute Body Condition Index


## CEWL

### Capture CEWL

variables:
- date = date of capture & baseline measurements
- individual lizard ID
- region = which body area the measurement was taken from
- TEWL_g_m2h = evaporative water loss

```{r}
cap_CEWL <- read.csv("./exported_data/capture_CEWL.csv") %>%
  dplyr::select(date, individual_ID, region, TEWL_g_m2h) %>%
  mutate(individual_ID = as.factor(individual_ID),
         date = as.Date(date, format = "%Y-%m-%d"),
         region = as.factor(region),
         day = as.factor("before"), # might change... tbd
         n_day = 0
         ) %>%
  dplyr::filter(individual_ID %in% all_dat$individual_ID)
summary(cap_CEWL)
```


### Post-Experiment CEWL

*In the future, I could automate this like I did for the HOBO data.*

Load in each of the post-rehab datafiles:

```{r}
# trial 1
CEWL_t1 <- read.csv("./data/post_exp_CEWL/4-28-21-CEWL.csv", # filename
                          na.strings=c("","NA")) %>% # fix empty cells
  # rename and select the pertinent variables/cols
  # I have to do this for each one 
  # so they all have the same number of columns for joining
  dplyr::select(date = Date, 
                Status,
                ID = Comments,
                TEWL_g_m2h = TEWL..g..m2h.. # rename
                )

# trial 2
CEWL_t2 <- read.csv("./data/post_exp_CEWL/5-4-21-CEWL.csv",
                          na.strings=c("","NA")) %>%
  dplyr::select(date = Date, 
                Status,
                ID = Comments,
                TEWL_g_m2h = TEWL..g..m2h..
                )

# trial 3
CEWL_t3 <- read.csv("./data/post_exp_CEWL/5-11-21-CEWL.csv",
                          na.strings=c("","NA")) %>%
  dplyr::select(date = Date, 
                Status,
                ID = Comments,
                TEWL_g_m2h = TEWL..g..m2h..
                )

# trial 4
CEWL_t4 <- read.csv("./data/post_exp_CEWL/5-18-21-CEWL.csv",
                          na.strings=c("","NA")) %>%
  dplyr::select(date = Date, 
                Status,
                ID = Comments,
                TEWL_g_m2h = TEWL..g..m2h..
                )
```


### Join Dataframes 

Merge all post-experiment CEWL, and add capture CEWL:

```{r}
# merge all CEWL datafiles & reformat
CEWL <- CEWL_t1 %>% # trial 1
  rbind(., CEWL_t2, # trial 2
        CEWL_t3, # trial 3
        CEWL_t4 # trial 4
        ) %>%
  # remove any unsuccessful measurements
  dplyr::filter(Status == "Normal") %>%
  # extract individual_ID and region separately from the "ID" variable
  separate(ID, c("individual_ID", "region")) %>%
  # reformat data
  dplyr::mutate(# reformat date
                date = as.Date(date, format = "%m/%d/%y"),
                # format individual ID as a factor
                individual_ID = as.factor(individual_ID),
                # set body region as a factor variable after getting only the consistent characters due to typos
                region = as.factor(substring(region, 1, 4)),
                # add when measurement taken
                day = as.factor("after"), # may rename...
                n_day = 1
                ) %>%
  # remove cols not relevant to stats
  dplyr::select(-Status) %>%
  # remove any rows with missing values
  dplyr::filter(complete.cases(.)) %>%
  # add capture CEWL data
  rbind(cap_CEWL) %>%
  # add tmt assignments
  left_join(tmts, by = "individual_ID") %>%
  mutate(humidity_tmt_percent = as.factor(humidity_tmt_percent))
summary(CEWL)
```

Before/after aren't perfectly even because sometimes we were unable to get the AquaFlux to equilibrate and take a measurement post-experiment.


## Export Data Frames for Power Analyses

```{r}
write.csv(all_dat, "exported_data/exp_effects_hydration.csv")
write.csv(CEWL, "exported_data/exp_effects_CEWL.csv")
```





# Data Cleaning

## Histograms

### Mass

```{r}
exp_dat %>%
  ggplot(., aes(x = mass_g)) +
  geom_histogram(color = "black", fill="steelblue", bins=50) + 
  theme_classic() +
  xlab("Mass (g)") + 
  ylab("Count")
simple.eda(exp_dat$mass_g)
shapiro.test(exp_dat$mass_g)
```

Mass distribution not normal, skewed to the left.


### Body Condition Index

```{r}
exp_dat %>%
  ggplot(., aes(x = mass_g)) +
  geom_histogram(color = "black", fill="steelblue", bins=50) + 
  theme_classic() +
  xlab("Mass (g)") + 
  ylab("Count")
simple.eda(exp_dat$mass_g)
shapiro.test(exp_dat$mass_g)
```


### Hematocrit

```{r}
exp_dat %>%
  ggplot(., aes(x = hematocrit_percent)) +
  geom_histogram(color = "black", fill="steelblue", bins=50) + 
  theme_classic() +
  xlab("Hematocrit (%)") + 
  ylab("Count")
simple.eda(exp_dat$hematocrit_percent)
shapiro.test(exp_dat$hematocrit_percent)
```

Visually, looks slightly skewed to the right, but statistically, the distribution of hematocrit is normal.


### Osmolality

```{r}
exp_dat %>%
  ggplot(., aes(x = osmolality_mmol_kg)) +
  geom_histogram(color = "black", fill="steelblue", bins=50) + 
  theme_classic() +
  xlab("Osmolality (mmol / kg)") + 
  ylab("Count")
simple.eda(exp_dat$osmolality_mmol_kg)
shapiro.test(exp_dat$osmolality_mmol_kg)
```

Visually, looks slightly skewed to the right, but statistically, the distribution of osmolality is normal.










# Basic Figures & SLR

### Mass ~ Time

```{r}
all_dat %>% 
  dplyr::filter(type != "rehab") %>%
  ggplot(data = .) + 
  geom_point(aes(x = day,
                 y = mass_g, 
                 color = as.factor(individual_ID)
                 ), 
             size = 1, 
             alpha = 0.6) +
  stat_smooth(aes(x = day, 
                  y = mass_g, 
                  color = as.factor(individual_ID)
                  ), 
              formula = y ~ x, 
              method = "lm", 
              se = F, 
              size = 1.6, 
              alpha = 1 ) + 
  theme_classic() + 
  scale_x_continuous(breaks = c(0, 2, 4, 6, 8)) +
  xlab("Day") + 
  ylab("Mass (g)") + 
  theme(text = element_text(color = "black", 
                            family = "sans", 
                            size = 12),
        axis.text = element_text(color = "black", 
                                 family = "sans", 
                                 size = 10),
        legend.text.align = 0,
        legend.position = "none"
)
```

```{r}
all_dat %>% 
  dplyr::filter(type != "rehab") %>%
  ggplot(data = .) + 
  geom_point(aes(x = day,
                 y = mass_g, 
                 color = humidity_tmt_percent
                 ), 
             size = 1, 
             alpha = 0.6) +
  stat_smooth(aes(x = day, 
                  y = mass_g, 
                  color = humidity_tmt_percent
                  ), 
              formula = y ~ x, 
              method = "lm", 
              se = F, 
              size = 1.6, 
              alpha = 1 ) + 
  theme_classic() + 
  scale_x_continuous(breaks = c(0, 2, 4, 6, 8)) +
  xlab("Day") + 
  ylab("Mass (g)") + 
  theme(text = element_text(color = "black", 
                            family = "sans", 
                            size = 12),
        axis.text = element_text(color = "black", 
                                 family = "sans", 
                                 size = 10),
        legend.text.align = 0
)
```

```{r}
mass_mod <- nlme::lme(data = all_dat,
               mass_g ~ day*humidity_tmt_percent,
               random = ~1|individual_ID)
summary(mass_mod)
```



### Hct ~ Time

```{r}
all_dat %>% 
  dplyr::filter(type != "rehab") %>%
  ggplot(data = .) + 
  geom_point(aes(x = day,
                 y = hematocrit_percent, 
                 color = as.factor(individual_ID)
                 ), 
             size = 1, 
             alpha = 0.6) +
  stat_smooth(aes(x = day, 
                  y = hematocrit_percent, 
                  color = as.factor(individual_ID)
                  ), 
              formula = y ~ x, 
              method = "lm", 
              se = F, 
              size = 1.6, 
              alpha = 1 ) + 
  theme_classic() + 
  scale_x_continuous(breaks = c(0, 2, 4, 6, 8)) +
  xlab("Day") + 
  ylab("Hematocrit (%)") + 
  theme(text = element_text(color = "black", 
                            family = "sans", 
                            size = 12),
        axis.text = element_text(color = "black", 
                                 family = "sans", 
                                 size = 10),
        legend.text.align = 0,
        legend.position = "none"
)
```

```{r}
all_dat %>% 
  dplyr::filter(type != "rehab") %>%
  ggplot(data = .) + 
  geom_point(aes(x = day,
                 y = hematocrit_percent, 
                 color = humidity_tmt_percent
                 ), 
             size = 1, 
             alpha = 0.6) +
  stat_smooth(aes(x = day, 
                  y = hematocrit_percent, 
                  color = humidity_tmt_percent
                  ), 
              formula = y ~ x, 
              method = "lm", 
              se = F, 
              size = 1.6, 
              alpha = 1 ) + 
  theme_classic() + 
  scale_x_continuous(breaks = c(0, 2, 4, 6, 8)) +
  xlab("Day") + 
  ylab("Hematocrit (%)") + 
  theme(text = element_text(color = "black", 
                            family = "sans", 
                            size = 12),
        axis.text = element_text(color = "black", 
                                 family = "sans", 
                                 size = 10),
        legend.text.align = 0
)
```

```{r}
hct_mod <- all_dat %>%
  dplyr::filter(complete.cases(hematocrit_percent)) %>%
  nlme::lme(data = .,
               hematocrit_percent ~ day + humidity_tmt_percent,
               random = ~1|individual_ID)
summary(hct_mod)
```

Treatment did NOT significantly affect hct, and both treatment groups lost approximately the same hct over time at the same rate.


### Osml ~ Time

```{r}
all_dat %>% 
  dplyr::filter(type != "rehab") %>%
  ggplot(data = .) + 
  geom_point(aes(x = day,
                 y = osmolality_mmol_kg, 
                 color = as.factor(individual_ID)
                 ), 
             size = 1, 
             alpha = 0.6) +
  stat_smooth(aes(x = day, 
                  y = osmolality_mmol_kg, 
                  color = as.factor(individual_ID)
                  ), 
              formula = y ~ x, 
              method = "lm", 
              se = F, 
              size = 1.6, 
              alpha = 1 ) + 
  facet_wrap(~humidity_tmt_percent) +
  theme_classic() + 
  scale_x_continuous(breaks = c(0, 2, 4, 6, 8)) +
  xlab("Day") + 
  ylab("Osmolality (mmol / kg)") + 
  theme(text = element_text(color = "black", 
                            family = "sans", 
                            size = 12),
        axis.text = element_text(color = "black", 
                                 family = "sans", 
                                 size = 10),
        legend.text.align = 0,
        legend.position = "none")
```

```{r}
all_dat %>% 
  dplyr::filter(type != "rehab") %>%
  ggplot(data = .) + 
  geom_point(aes(x = day,
                 y = osmolality_mmol_kg, 
                 color = as.factor(humidity_tmt_percent)
                 ), 
             size = 1, 
             alpha = 0.6) +
  stat_smooth(aes(x = day, 
                  y = osmolality_mmol_kg, 
                  color = as.factor(humidity_tmt_percent)
                  ), 
              formula = y ~ x, 
              method = "lm", 
              se = F, 
              size = 1.6, 
              alpha = 1 ) + 
  facet_wrap(~humidity_tmt_percent) +
  theme_classic() + 
  scale_x_continuous(breaks = c(0, 2, 4, 6, 8)) +
  xlab("Day") + 
  ylab("Osmolality (mmol / kg)") + 
  theme(text = element_text(color = "black", 
                            family = "sans", 
                            size = 12),
        axis.text = element_text(color = "black", 
                                 family = "sans", 
                                 size = 10),
        legend.text.align = 0,
        legend.position = "none")
```

I think this is the line if all the points were aggregated... how do I get the mean line?? i.e. I want the mean slope to make a line.

```{r}
all_dat %>% 
  dplyr::filter(type != "rehab") %>%
  ggplot(data = .) + 
  geom_point(aes(x = day,
                 y = osmolality_mmol_kg, 
                 color = humidity_tmt_percent
                 ), 
             size = 1, 
             alpha = 0.6) +
  stat_smooth(aes(x = day, 
                  y = osmolality_mmol_kg, 
                  color = humidity_tmt_percent
                  ), 
              formula = y ~ x, 
              method = "lm", 
              se = F, 
              size = 1.6, 
              alpha = 1 ) + 
  theme_classic() + 
  scale_x_continuous(breaks = c(0, 2, 4, 6, 8)) +
  xlab("Date") + 
  ylab("Osmolality (mmol / kg)") + 
  theme(text = element_text(color = "black", 
                            family = "sans", 
                            size = 12),
        axis.text = element_text(color = "black", 
                                 family = "sans", 
                                 size = 10),
        legend.text.align = 0
)
```

I don't think this graph is necessarily informative... 


```{r}
osml_mod <- all_dat %>%
  dplyr::filter(complete.cases(osmolality_mmol_kg)) %>%
  nlme::lme(data = .,
               osmolality_mmol_kg ~ day*humidity_tmt_percent,
               random = ~1|individual_ID)
summary(osml_mod)
```


### Change in Osmolality

```{r}
osml_d0 <- all_dat %>%
  dplyr::filter(day == 0) %>%
  dplyr::select(individual_ID, osml0 = osmolality_mmol_kg, 
                humidity_tmt_percent)
osml_d8 <- all_dat %>%
  dplyr::filter(day %in% c(8,9)) %>%
  dplyr::select(individual_ID, osml89 = osmolality_mmol_kg, 
                humidity_tmt_percent)

osml_diffs <- osml_d0 %>%
  left_join(osml_d8) %>%
  mutate(osml_change = osml89 - osml0)
```


boxplot:

```{r}
osml_diffs %>% 
  ggplot(data = .) + 
  geom_boxplot(aes(x = humidity_tmt_percent, 
                   y = osml_change, 
                   group = humidity_tmt_percent
                   ), 
               size = 1,
               alpha = 1) + 
  #facet_wrap(~humidity_tmt_percent) +
  theme_classic() + 
  xlab("") + 
  ylab("Osmolality Change (mmol / kg)") + 
  #annotate("text", x = 1.5, y = 45, 
   #        label = "paste(italic(p), \" = 0.0152\")", 
    #       parse = TRUE,
     #      size = 6) +
  #ylim(10, 50) +
  #scale_x_discrete(labels = c("F" = "Female",
   #                           "M" = "Male")) +
  scale_color_brewer(palette = "Set2") +
  theme(text = element_text(color = "black", 
                            family = "sans", 
                            size = 18),
        axis.text = element_text(color = "black", 
                                 family = "sans", 
                                 size = 14),
        legend.text.align = 0,
        legend.position = "none"
) #-> CEWL_fig
#CEWL_fig

# export figure
#ggsave(filename = "hct_sex_fig.tiff",
 #      plot = hct_sex_fig,
  #     path = "./final_figures",
   #    device = "tiff",
    #   dpi = 1200,
     #  width = 6, height = 4)

```

model to test statistical significance of difference:

```{r}
osml_diff_mod <- lm(data = osml_diffs,
                    osml_change ~ humidity_tmt_percent)
summary(osml_diff_mod)
```
Not different between the two treatment groups, and neither significantly different from zero.


### CEWL ~ Before/After

try a boxplot:

```{r}
CEWL %>% 
  ggplot(data = .) + 
  geom_boxplot(aes(x = humidity_tmt_percent, 
                   y = TEWL_g_m2h, 
                   color = day
                   ), 
               size = 1,
               alpha = 1) + 
  facet_wrap(~region) +
  theme_classic() + 
  xlab("") + 
  ylab("CEWL (g / m^2h)") + 
  #annotate("text", x = 1.5, y = 45, 
   #        label = "paste(italic(p), \" = 0.0152\")", 
    #       parse = TRUE,
     #      size = 6) +
  #ylim(10, 50) +
  #scale_x_discrete(labels = c("F" = "Female",
   #                           "M" = "Male")) +
  scale_color_brewer(palette = "Set2") +
  theme(text = element_text(color = "black", 
                            family = "sans", 
                            size = 18),
        axis.text = element_text(color = "black", 
                                 family = "sans", 
                                 size = 14),
        legend.text.align = 0,
        legend.position = "bottom"
) -> CEWL_fig
CEWL_fig

# export figure
#ggsave(filename = "hct_sex_fig.tiff",
 #      plot = hct_sex_fig,
  #     path = "./final_figures",
   #    device = "tiff",
    #   dpi = 1200,
     #  width = 6, height = 4)

```

this is difficult to see changes, I think a line graph would be better...

```{r}
CEWL %>% 
  ggplot(data = .) + 
  geom_point(aes(x = n_day,
                 y = TEWL_g_m2h, 
                 color = humidity_tmt_percent
                 ), 
             size = 1, 
             alpha = 0.6) +
  geom_line(aes(x = n_day, 
                  y = TEWL_g_m2h, 
                  color = humidity_tmt_percent
                  )) + 
  theme_classic() + 
  facet_wrap(~region) +
  scale_x_continuous(breaks = c(0, 1),
                     labels = c("0" = "before", "1" = "after")) +
  xlab("") + 
  ylab("TEWL (g / m2h)") + 
  theme(text = element_text(color = "black", 
                            family = "sans", 
                            size = 12),
        axis.text = element_text(color = "black", 
                                 family = "sans", 
                                 size = 10),
        legend.text.align = 0
)
```
I think this graph is awesome, but we lose the individual variation...

```{r}
CEWL_mod <- all_dat %>%
  dplyr::filter(complete.cases(hematocrit_percent)) %>%
  nlme::lme(data = .,
               hematocrit_percent ~ day + humidity_tmt_percent,
               random = ~1|individual_ID)
summary(CEWL_mod)
```


### Change in CEWL

```{r}
CEWL_before <- CEWL %>%
  dplyr::filter(day == "before") %>%
  dplyr::select(CEWL_before = TEWL_g_m2h,
                humidity_tmt_percent, trial_number,
                individual_ID, region)
CEWL_after <- CEWL %>%
  dplyr::filter(day == "after") %>%
  dplyr::select(CEWL_after = TEWL_g_m2h,
                humidity_tmt_percent, trial_number,
                individual_ID, region)

CEWL_diffs <- CEWL_before %>%
  left_join(CEWL_after, by = c('individual_ID', 'region',
                'humidity_tmt_percent', 'trial_number')) %>%
  mutate(CEWL_diff = CEWL_after - CEWL_before)
```


plot:

```{r}
CEWL_diffs %>% 
  ggplot(data = .) + 
  geom_boxplot(aes(x = humidity_tmt_percent, 
                   y = CEWL_diff, 
                   group = humidity_tmt_percent
                   ), 
               size = 1,
               alpha = 1) + 
  #facet_wrap(~humidity_tmt_percent) +
  theme_classic() + 
  xlab("") + 
  ylab("CEWL Change ()") + 
  #annotate("text", x = 1.5, y = 45, 
   #        label = "paste(italic(p), \" = 0.0152\")", 
    #       parse = TRUE,
     #      size = 6) +
  #ylim(10, 50) +
  #scale_x_discrete(labels = c("F" = "Female",
   #                           "M" = "Male")) +
  scale_color_brewer(palette = "Set2") +
  theme(text = element_text(color = "black", 
                            family = "sans", 
                            size = 18),
        axis.text = element_text(color = "black", 
                                 family = "sans", 
                                 size = 14),
        legend.text.align = 0,
        legend.position = "none"
)
```


model:

```{r}
CEW_diffs_mod <- lm(data = CEWL_diffs,
                    CEWL_diff ~ humidity_tmt_percent)
summary(CEW_diffs_mod)
```










